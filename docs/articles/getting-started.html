<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Getting Started • adobeanalyticsr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><script src="../extra.js"></script><meta property="og:title" content="Getting Started">
<meta property="og:description" content="adobeanalyticsr">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-06XDF7JD6E"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-06XDF7JD6E');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">adobeanalyticsr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/getting-started.html">Getting Started</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/benrwoodard/adobeanalyticsr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Getting Started</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/benrwoodard/adobeanalyticsr/blob/HEAD/vignettes/getting-started.Rmd" class="external-link"><code>vignettes/getting-started.Rmd</code></a></small>
      <div class="hidden name"><code>getting-started.Rmd</code></div>

    </div>

    
    
<p>This vignette goes through the basics of getting started with <code>adobeanalyticsr</code>.</p>
<div class="section level2">
<h2 id="basic-setup">Basic Setup<a class="anchor" aria-label="anchor" href="#basic-setup"></a>
</h2>
<p>The basic setup is documented on the home page of <a href="https://adobeanalyticsr.com" class="external-link">adobeanalyticsr.com</a>, which reviews the details for:</p>
<ul>
<li>Creating an Adobe Console API project through <a href="https://developer.adobe.com/console" class="external-link uri">https://developer.adobe.com/console</a> (this is available with all Adobe Analytics accounts, but requires the appropriate level of admin access to set up the project)</li>
<li>Adding <code>AW_CLIENT_ID</code> and <code>AW_CLIENT_SECRET</code> environment variables (the recommended mechanism for this is through the <code>.Renviron</code> file). If these environment variables are not available, then the <code>client_id</code> and <code>client_secret</code> arguments in <code><a href="../reference/aw_token.html">aw_token()</a></code> need to be populated with the client ID and secret.</li>
<li>Adding <code>AW_COMPANY_ID</code> and <code>AW_REPORTSUITE_ID</code> environment variables (again, this is recommended to be done via a <code>.Renviron</code> file).</li>
</ul>
</div>
<div class="section level2">
<h2 id="understanding-aw_company_id-and-aw_reportsuite_id">Understanding AW_COMPANY_ID and AW_REPORTSUITE_ID<a class="anchor" aria-label="anchor" href="#understanding-aw_company_id-and-aw_reportsuite_id"></a>
</h2>
<p>Many <code>adobeanalyticsr</code> functions require a company ID (the Adobe account being accessed) and a report suite ID (the specific report suite to pull data or information from) to run. As such, these are arguments (<code>company_id</code> and <code>rsid</code>) within those functions that default to the values for the <code>AW_COMPANY_ID</code> and <code>AW_REPORTSUITE_ID</code> environment variables.</p>
<p>This approach has some important ramifications:</p>
<ul>
<li>If you primarily access a single company and/or a single report suite, then creating <code>AW_COMPANY_ID</code> and <code>AW_REPORTSUITE_ID</code> environment variables means you will <em>not</em> have to set them on every function call, which can make for shorter and cleaner code.</li>
<li>If you periodically (or often) need to use a different <code>company_id</code> or <code>rsid</code> from what is specified as an environment variable, all you need to do is call them explicitly within the function calls. The values you specify for either of these (or both of them) directly in a function call will take precedence over any environment variables that are set up (this is core R behavior: function arguments often have default values built into them, but any value specified in the code will be used in place of those defaults; this is not anything unique to <code>adobeanalyticsr</code>).<br>
</li>
<li>If you do <em>not</em> have <code>AW_COMPANY_ID</code> and <code>AW_REPORTSUITE_ID</code> environment variables created <em>and</em> you do not specify values for them in the <code>adobeanalyticsr</code> function calls, then the functions will fail.</li>
</ul>
<p>In this vignette, both <code>AW_COMPANY_ID</code> and <code>AW_REPORTSUITE_ID</code> environment variables have been set up (but not shown).</p>
</div>
<div class="section level2">
<h2 id="load-the-package-and-authenticate">Load the Package and Authenticate<a class="anchor" aria-label="anchor" href="#load-the-package-and-authenticate"></a>
</h2>
<p>Once the package is loaded, authenticate with <code><a href="../reference/aw_token.html">aw_token()</a></code>. If you have not authenticated ever, or if you have not authenticated within the last 24 hours, then a browser should open requiring you to log in to your Adobe account, and it will then redirect you to a web page that displays a lengthy token that you can copy and paste back into an <strong>Enter your authorization code:</strong> prompt in the R console.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>            <span class="co"># Light cleanup of output</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span>            <span class="co"># Cleaner data tables</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/benrwoodard/adobeanalyticsr" class="external-link">adobeanalyticsr</a></span><span class="op">)</span>
<span class="fu"><a href="../reference/aw_token.html">aw_token</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>The token will look something like this (with different letters and numbers and characters):</p>
<pre><code>eyJ4NXUiOiJpbXNfbmExLWtleS0xLmNlciIsImFsZyI6IlJTMjU2In0.eyJpZCI6IjE2MTI3MTEyMjM5MzNfNGE2ZmVlM2-tYzdkOS00M2QyLWI5ODUtYzAzMDk2NDA2MGFjX3VlMSIsImNsaWVudF9pZCI6IjA2MTU0ZDgzMjl-OTQxZjViMGUzM2EwZGM2M2U3NmQxIiwidXNlcl9pZCI6IkY2MUJBOTU0NUE3QjMyM0QwQTQ5NUQ2Q0BBZG9iZUlEI-wic3RhdGUiOiIiLCJKeXBlIjoiYXV0aG9yaXphdGlvbl9jb2RlIiwiYXMiOiJpbXMtbmExIiwiZmciO-JWRlFSUkhCTVhMTzU2SDRDRTZSTFJZZUE0TT09PT09PSIsInNpZCI6IjE2MTI3MTEyMjM5MzNfMWE2ZDc4ZTUtNT-zZi00OWFkLWFmZTktYTk0MTJkZmYwMzA0X3VlMSIsIm90byI3InRydWUiLCJleHBpcmVzX2luIjoiMT-wMDAwMCIsImNyZWF0ZWRfYXQiOiIxNjEyNzExMjIzOTMzIiwic2NvcGUiOiJvcGVuaWQsQWRvYmVJRCxyZWFkX-9yZ2FuaXphdGlvbnMsYWRkaXRpb25hbF9pbmZvLnByb2plY3RlZFByb2R1Y3RDb250ZXh0LGFkZGl0aW9uY-xfaW5mby5qb2JfZnVuY3Rpb24ifQ.EvoihD7IPXkew_yFQuzjZGfiU_Q8-vlUkmytwfB_Y46DKePINPn7URq8bit0dXoO-tUdMUKVNOHEBbqww6ydDGBPHSCbOH1GgNsILoN96tjHTtA-jDxN8jrAnQ0PuCssA-GePnqryxCxOH9WyZIl2fog00ib8iZ3ZFAJLDrvthWwWHUw-ivu-K-F3UAtU7A4ma_7pe07D1rW5MhTcZOSr0pri68bjFA86cJqH5DHyMdp4F2d7QgZcYPMdrvVfXTwWXv9s5r6huvDcqv6nny-WOKZbKmoP6zwMzn5xa343wrQ5oXFbRxYem-tC154_dc7ekrC8YUX0pY5up9a-OUy0w</code></pre>
<p>Confirm that the authorization worked by running <code><a href="../reference/get_me.html">get_me()</a></code>, which will return two things if the authorization was successful:</p>
<ol style="list-style-type: decimal">
<li>A message: <code>Your data is now available!</code>
</li>
<li>A data frame showing the company ID (<code>globalCompanyId</code>) and company name (<code>companyName</code>) for all of the companies (accounts) to which you have access based on the login you used when you called <code><a href="../reference/aw_token.html">aw_token()</a></code>.</li>
</ol>
</div>
<div class="section level2">
<h2 id="get-available-dimensions-metrics-and-segments">Get Available Dimensions, Metrics, and Segments<a class="anchor" aria-label="anchor" href="#get-available-dimensions-metrics-and-segments"></a>
</h2>
<p>Because the Adobe Analytics API works with the variable and segment <em>IDs</em> rather than the plain English names of dimensions, metrics, and segments, it is often useful, at least in the initial development of a project, to create data frames that contain all of the available values for these three types of variables.</p>
<div class="section level3">
<h3 id="get-available-dimensions">Get Available Dimensions<a class="anchor" aria-label="anchor" href="#get-available-dimensions"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dims_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aw_get_dimensions.html">aw_get_dimensions</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Auto-refreshing stale OAuth token.</span>
<span class="co">#&gt; Warning: Unable to refresh token: unauthorized_client</span>
<span class="co">#&gt; Request failed [401]. Retrying in 1 seconds...</span>
<span class="co">#&gt; Auto-refreshing stale OAuth token.</span>
<span class="co">#&gt; Warning: Unable to refresh token: unauthorized_client</span>
<span class="co">#&gt; Request failed [401]. Retrying in 1 seconds...</span>
<span class="co">#&gt; Auto-refreshing stale OAuth token.</span>
<span class="co">#&gt; Warning: Unable to refresh token: unauthorized_client</span>
<span class="co">#&gt; Error in aw_call_api(req_path = urlstructure, debug = debug, company_id = company_id): Unauthorized (HTTP 401).</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dims_df</span>, <span class="fl">10</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">name</span>, <span class="va">type</span>, <span class="va">category</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">id</th>
<th align="left">name</th>
<th align="left">type</th>
<th align="left">category</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">averagepagetime</td>
<td align="left">Time Spent on Page - Bucketed</td>
<td align="left">ordered-enum</td>
<td align="left">Metrics</td>
</tr>
<tr class="even">
<td align="left">browser</td>
<td align="left">Browser</td>
<td align="left">string</td>
<td align="left">Audience</td>
</tr>
<tr class="odd">
<td align="left">browserheight</td>
<td align="left">Browser Height - Granular</td>
<td align="left">int</td>
<td align="left">Audience</td>
</tr>
<tr class="even">
<td align="left">browserheightbucketed</td>
<td align="left">Browser Height - Bucketed</td>
<td align="left">ordered-enum</td>
<td align="left">Audience</td>
</tr>
<tr class="odd">
<td align="left">browsertype</td>
<td align="left">Browser Type</td>
<td align="left">enum</td>
<td align="left">Audience</td>
</tr>
<tr class="even">
<td align="left">browserwidth</td>
<td align="left">Browser Width - Granular</td>
<td align="left">int</td>
<td align="left">Audience</td>
</tr>
<tr class="odd">
<td align="left">browserwidthbucketed</td>
<td align="left">Browser Width - Bucketed</td>
<td align="left">ordered-enum</td>
<td align="left">Audience</td>
</tr>
<tr class="even">
<td align="left">campaign</td>
<td align="left">Tracking Code</td>
<td align="left">string</td>
<td align="left">Traffic Sources</td>
</tr>
<tr class="odd">
<td align="left">campaign.1</td>
<td align="left">Campaign Source</td>
<td align="left">string</td>
<td align="left">Traffic Sources</td>
</tr>
<tr class="even">
<td align="left">campaign.2</td>
<td align="left">Campaign Medium</td>
<td align="left">string</td>
<td align="left">Traffic Sources</td>
</tr>
</tbody>
</table>
<p>This data frame includes:</p>
<ul>
<li>Standard, out-of-the-box dimensions</li>
<li>Custom dimensions (eVars and s.props)</li>
<li>
<em>Classifications</em> of dimensions: these are identifiable because their <code>id</code> values are <code>[classified variable].[num]</code> and they have a non-<code>NA</code> value for <code>parent</code> (the <code>parent</code> column–not shown above–has the name of the classified variable)</li>
</ul>
<p>The data frame can then be searched and filtered for specific dimensions for use in subsequent data calls.</p>
</div>
<div class="section level3">
<h3 id="get-available-metrics">Get Available Metrics<a class="anchor" aria-label="anchor" href="#get-available-metrics"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">metrics_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aw_get_metrics.html">aw_get_metrics</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">metrics_df</span>, <span class="fl">10</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">name</span>, <span class="va">type</span>, <span class="va">category</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">id</th>
<th align="left">name</th>
<th align="left">type</th>
<th align="left">category</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">averagepagedepth</td>
<td align="left">Average Page Depth</td>
<td align="left">int</td>
<td align="left">Traffic</td>
</tr>
<tr class="even">
<td align="left">averagetimespentonpage</td>
<td align="left">Average Time Spent on Page (seconds)</td>
<td align="left">int</td>
<td align="left">Traffic</td>
</tr>
<tr class="odd">
<td align="left">averagetimespentonsite</td>
<td align="left">Average Time Spent on Site (seconds)</td>
<td align="left">int</td>
<td align="left">Traffic</td>
</tr>
<tr class="even">
<td align="left">averagevisitdepth</td>
<td align="left">Average Visit Depth</td>
<td align="left">int</td>
<td align="left">Traffic</td>
</tr>
<tr class="odd">
<td align="left">bouncerate</td>
<td align="left">Bounce Rate</td>
<td align="left">percent</td>
<td align="left">Traffic</td>
</tr>
<tr class="even">
<td align="left">bounces</td>
<td align="left">Bounces</td>
<td align="left">int</td>
<td align="left">Traffic</td>
</tr>
<tr class="odd">
<td align="left">campaigninstances</td>
<td align="left">Campaign Click-throughs</td>
<td align="left">int</td>
<td align="left">Traffic Sources</td>
</tr>
<tr class="even">
<td align="left">cartadditions</td>
<td align="left">Cart Additions</td>
<td align="left">int</td>
<td align="left">Conversion</td>
</tr>
<tr class="odd">
<td align="left">cartremovals</td>
<td align="left">Cart Removals</td>
<td align="left">int</td>
<td align="left">Conversion</td>
</tr>
<tr class="even">
<td align="left">carts</td>
<td align="left">Carts</td>
<td align="left">int</td>
<td align="left">Conversion</td>
</tr>
</tbody>
</table>
<p>This data frame includes:</p>
<ul>
<li>Standard, out-of-the-box metrics</li>
<li>Custom metrics (events)</li>
</ul>
<p><code><a href="../reference/aw_get_metrics.html">aw_get_metrics()</a></code> does <em>not</em> return <em>calculated metrics</em>, so those require a separate function call.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">calc_metrics_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aw_get_calculatedmetrics.html">aw_get_calculatedmetrics</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">calc_metrics_df</span>, <span class="fl">10</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">name</span>, <span class="va">type</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">id</th>
<th align="left">name</th>
<th align="left">type</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">cm300003965_557fc577e4b07e827d177ad0</td>
<td align="left">Crash Rate (Mobile)</td>
<td align="left">percent</td>
</tr>
<tr class="even">
<td align="left">cm300003965_557fc577e4b07e827d177ad3</td>
<td align="left">Average Session Length (Mobile)</td>
<td align="left">time</td>
</tr>
<tr class="odd">
<td align="left">cm300003965_557fc578e4b0094eea4f5201</td>
<td align="left">Single Access (Calculated)</td>
<td align="left">decimal</td>
</tr>
<tr class="even">
<td align="left">cm300003965_557fc578e4b0094eea4f5204</td>
<td align="left">Crash Rate (Mobile)</td>
<td align="left">percent</td>
</tr>
<tr class="odd">
<td align="left">cm300003965_557fc578e4b0416196926008</td>
<td align="left">Average Session Length (Mobile)</td>
<td align="left">time</td>
</tr>
<tr class="even">
<td align="left">cm300003965_557fc656e4b0adadba08f337</td>
<td align="left">Avg. Order Value</td>
<td align="left">currency</td>
</tr>
<tr class="odd">
<td align="left">cm300003965_557fc656e4b0094eea4f58b6</td>
<td align="left">Average Order Value</td>
<td align="left">decimal</td>
</tr>
<tr class="even">
<td align="left">cm300003965_557fc656e4b0094eea4f58b8</td>
<td align="left">Bounce Rate</td>
<td align="left">decimal</td>
</tr>
<tr class="odd">
<td align="left">cm300003965_557fc790e4b0094eea4f6222</td>
<td align="left">Crash Rate (Mobile)</td>
<td align="left">percent</td>
</tr>
<tr class="even">
<td align="left">cm300003965_557fc790e4b0416196926fac</td>
<td align="left">Average Session Length (Mobile)</td>
<td align="left">time</td>
</tr>
</tbody>
</table>
<p>Calculated metric IDs start with <code>cm</code> and are assigned by Adobe when the calculated metric is created.</p>
<p>These two metrics data frames can be searched and filtered for specific metrics for use in subsequent data calls.</p>
</div>
<div class="section level3">
<h3 id="get-available-segments">Get Available Segments<a class="anchor" aria-label="anchor" href="#get-available-segments"></a>
</h3>
<p>The default limit for the number of segments returned by the <code><a href="../reference/aw_get_segments.html">aw_get_segments()</a></code> function is 10, so, depending on the number of segments you have, the limit value can be increased to return a complete list of segments.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">segments_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aw_get_segments.html">aw_get_segments</a></span><span class="op">(</span>limit <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">segments_df</span><span class="op">)</span>
<span class="co">#&gt; [1] "name"        "description" "id"          "owner"       "migratedIds" "rsid"</span></code></pre></div>
<p>Similar to the dimensions and metrics, <code><a href="../reference/aw_get_segments.html">aw_get_segments()</a></code> returns a data frame of available segments that can be searched and filtered to identify the specific <code>id</code> values to use in subsequent data calls.</p>
</div>
</div>
<div class="section level2">
<h2 id="freeform-table-data-pull">Freeform Table Data Pull<a class="anchor" aria-label="anchor" href="#freeform-table-data-pull"></a>
</h2>
<p>Just as in Analysis Workspace, the freeform table is the workhorse of <code>adobeanalyticsr</code>, and, as such, is the focus of the rest of this vignette.</p>
<div class="section level3">
<h3 id="single-dimension-single-metric">Single Dimension, Single Metric<a class="anchor" aria-label="anchor" href="#single-dimension-single-metric"></a>
</h3>
<p>The following is a breakdown of visits by device category for the last 30 full days for the report suite that is specified in the <code>AW_REPORTSUITE_ID</code> environment variable.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Specify a start date and end date. These can be specified as Date</span>
<span class="co"># objects or as string objects in YYYY-MM-DD format.</span>
<span class="va">start_date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">30</span>
<span class="va">end_date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>

<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aw_freeform_table.html">aw_freeform_table</a></span><span class="op">(</span>date_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">start_date</span>, <span class="va">end_date</span><span class="op">)</span>,
                        dimensions <span class="op">=</span> <span class="st">"mobiledevicetype"</span>,
                        metrics <span class="op">=</span> <span class="st">"visits"</span><span class="op">)</span>
<span class="co">#&gt; A total of 3 rows have been pulled.</span>

<span class="co"># Output the results as a formatted table</span>
<span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">mobiledevicetype</th>
<th align="right">visits</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Other</td>
<td align="right">5546</td>
</tr>
<tr class="even">
<td align="left">Mobile Phone</td>
<td align="right">1509</td>
</tr>
<tr class="odd">
<td align="left">Tablet</td>
<td align="right">28</td>
</tr>
</tbody>
</table>
<p>Note that the <code>top</code> argument for <code><a href="../reference/aw_freeform_table.html">aw_freeform_table()</a></code> defaults to <code>5</code>, so only the top 5 values will be shown unless that argument is passed a higher value.</p>
</div>
<div class="section level3">
<h3 id="single-dimension-multiple-metrics">Single Dimension, Multiple Metrics<a class="anchor" aria-label="anchor" href="#single-dimension-multiple-metrics"></a>
</h3>
<p>Getting multiple metrics is simply a matter of passing a vector to the <code>metrics</code> argument rather than a single string:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aw_freeform_table.html">aw_freeform_table</a></span><span class="op">(</span>date_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">start_date</span>, <span class="va">end_date</span><span class="op">)</span>,
                        dimensions <span class="op">=</span> <span class="st">"mobiledevicetype"</span>,
                        metrics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"visits"</span>, <span class="st">"pageviews"</span>, <span class="st">"visitors"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; A total of 3 rows have been pulled.</span>

<span class="co"># Output the results as a formatted table</span>
<span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">mobiledevicetype</th>
<th align="right">visits</th>
<th align="right">pageviews</th>
<th align="right">visitors</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Other</td>
<td align="right">5546</td>
<td align="right">10055</td>
<td align="right">3829</td>
</tr>
<tr class="even">
<td align="left">Mobile Phone</td>
<td align="right">1509</td>
<td align="right">2414</td>
<td align="right">1216</td>
</tr>
<tr class="odd">
<td align="left">Tablet</td>
<td align="right">28</td>
<td align="right">95</td>
<td align="right">23</td>
</tr>
</tbody>
</table>
<p>The example above used standard metrics, but custom metrics (e.g., “event10”) and calculated metrics (e.g., “cm300003965_557fc578e4b0094efa4f5204”) can also be included in the vector of metrics as needed.</p>
<p>The default for the function is to return the API field names, but the “pretty names” can be returned instead by setting the <code>prettynames</code> argument to <code>TRUE</code>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aw_freeform_table.html">aw_freeform_table</a></span><span class="op">(</span>date_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">start_date</span>, <span class="va">end_date</span><span class="op">)</span>,
                        dimensions <span class="op">=</span> <span class="st">"mobiledevicetype"</span>,
                        metrics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"visits"</span>, <span class="st">"pageviews"</span>, <span class="st">"visitors"</span><span class="op">)</span>,
                        prettynames <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; A total of 3 rows have been pulled.</span>

<span class="co"># Output the results as a formatted table</span>
<span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Mobile Device Type</th>
<th align="right">Visits</th>
<th align="right">Page Views</th>
<th align="right">Unique Visitors</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Other</td>
<td align="right">5546</td>
<td align="right">10055</td>
<td align="right">3829</td>
</tr>
<tr class="even">
<td align="left">Mobile Phone</td>
<td align="right">1509</td>
<td align="right">2414</td>
<td align="right">1216</td>
</tr>
<tr class="odd">
<td align="left">Tablet</td>
<td align="right">28</td>
<td align="right">95</td>
<td align="right">23</td>
</tr>
</tbody>
</table>
<p>While the pretty names are, indeed, “prettier,” they can add downstream complexity to the code. And, since custom metrics and calculated metrics can have their names changed at any point, if subsequent code references columns using these pretty names, the code is subject to break in the future if the metric(s) it references gets renamed. So, it is generally considered a best practice to work with the API field names (<code>prettynames = FALSE</code>) and then only convert to more readable names at the point of the data being presented to the end user.</p>
</div>
<div class="section level3">
<h3 id="trending-metrics-over-time">Trending Metrics Over Time<a class="anchor" aria-label="anchor" href="#trending-metrics-over-time"></a>
</h3>
<p>What is time? This could be a deeply philosophical question, but, instead, we’ll treat it as a pragmatic one: time is a dimension. It’s just a dimension that gets some special treatment in this package.</p>
<p>The first thing to note is that the <code>id</code> values for time values are all prepended with <code>daterange</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dims_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"^daterange.*"</span>, <span class="va">id</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">name</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">id</th>
<th align="left">name</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">daterangeday</td>
<td align="left">Day</td>
</tr>
<tr class="even">
<td align="left">daterangehour</td>
<td align="left">Hour</td>
</tr>
<tr class="odd">
<td align="left">daterangeminute</td>
<td align="left">Minute</td>
</tr>
<tr class="even">
<td align="left">daterangemonth</td>
<td align="left">Month</td>
</tr>
<tr class="odd">
<td align="left">daterangequarter</td>
<td align="left">Quarter</td>
</tr>
<tr class="even">
<td align="left">daterangeweek</td>
<td align="left">Week</td>
</tr>
<tr class="odd">
<td align="left">daterangeyear</td>
<td align="left">Year</td>
</tr>
</tbody>
</table>
<p>To get trended data for one or more metrics, simply use the appropriate date dimension as a dimension. The first “special” thing that happens here is that you don’t need to worry about setting the <code>top</code> argument to include all of the values. The package will assume that you want to include all of the date values in the range and will do this automatically.</p>
<p>What will <em>not</em> (yet) be done automatically is for the package to return the results ordered by the date value (it will sort them by the first metric or whatever is specified in the <code>metricSort</code> argument), so we’ll need to do that sorting with the results:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aw_freeform_table.html">aw_freeform_table</a></span><span class="op">(</span>date_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">start_date</span>, <span class="va">end_date</span><span class="op">)</span>,
                        dimensions <span class="op">=</span> <span class="st">"daterangeday"</span>,
                        metrics <span class="op">=</span> <span class="st">"visits"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">daterangeday</span><span class="op">)</span>
<span class="co">#&gt; A total of 30 rows have been pulled.</span>

<span class="co"># Output the results as a formatted table</span>
<span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">daterangeday</th>
<th align="right">visits</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">2021-01-23</td>
<td align="right">66</td>
</tr>
<tr class="even">
<td align="left">2021-01-24</td>
<td align="right">67</td>
</tr>
<tr class="odd">
<td align="left">2021-01-25</td>
<td align="right">268</td>
</tr>
<tr class="even">
<td align="left">2021-01-26</td>
<td align="right">359</td>
</tr>
<tr class="odd">
<td align="left">2021-01-27</td>
<td align="right">331</td>
</tr>
<tr class="even">
<td align="left">2021-01-28</td>
<td align="right">291</td>
</tr>
<tr class="odd">
<td align="left">2021-01-29</td>
<td align="right">257</td>
</tr>
<tr class="even">
<td align="left">2021-01-30</td>
<td align="right">81</td>
</tr>
<tr class="odd">
<td align="left">2021-01-31</td>
<td align="right">99</td>
</tr>
<tr class="even">
<td align="left">2021-02-01</td>
<td align="right">286</td>
</tr>
<tr class="odd">
<td align="left">2021-02-02</td>
<td align="right">336</td>
</tr>
<tr class="even">
<td align="left">2021-02-03</td>
<td align="right">396</td>
</tr>
<tr class="odd">
<td align="left">2021-02-04</td>
<td align="right">334</td>
</tr>
<tr class="even">
<td align="left">2021-02-05</td>
<td align="right">329</td>
</tr>
<tr class="odd">
<td align="left">2021-02-06</td>
<td align="right">85</td>
</tr>
<tr class="even">
<td align="left">2021-02-07</td>
<td align="right">119</td>
</tr>
<tr class="odd">
<td align="left">2021-02-08</td>
<td align="right">372</td>
</tr>
<tr class="even">
<td align="left">2021-02-09</td>
<td align="right">557</td>
</tr>
<tr class="odd">
<td align="left">2021-02-10</td>
<td align="right">352</td>
</tr>
<tr class="even">
<td align="left">2021-02-11</td>
<td align="right">337</td>
</tr>
<tr class="odd">
<td align="left">2021-02-12</td>
<td align="right">244</td>
</tr>
<tr class="even">
<td align="left">2021-02-13</td>
<td align="right">85</td>
</tr>
<tr class="odd">
<td align="left">2021-02-14</td>
<td align="right">106</td>
</tr>
<tr class="even">
<td align="left">2021-02-15</td>
<td align="right">193</td>
</tr>
<tr class="odd">
<td align="left">2021-02-16</td>
<td align="right">260</td>
</tr>
<tr class="even">
<td align="left">2021-02-17</td>
<td align="right">214</td>
</tr>
<tr class="odd">
<td align="left">2021-02-18</td>
<td align="right">307</td>
</tr>
<tr class="even">
<td align="left">2021-02-19</td>
<td align="right">207</td>
</tr>
<tr class="odd">
<td align="left">2021-02-20</td>
<td align="right">65</td>
</tr>
<tr class="even">
<td align="left">2021-02-21</td>
<td align="right">84</td>
</tr>
</tbody>
</table>
<p>To include a non-date dimension and specify a <code>top</code> value for that dimension while also returning all of the date values, use <code>0</code> in the position of the date dimension when specifying the <code>top</code> argument.</p>
<p>The following code breaks down each day by <strong>Mobile Device Type</strong>, but only includes the top 2 values for each breakdown:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aw_freeform_table.html">aw_freeform_table</a></span><span class="op">(</span>date_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">start_date</span>, <span class="va">end_date</span><span class="op">)</span>,
                        dimensions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"daterangeday"</span>, <span class="st">"mobiledevicetype"</span><span class="op">)</span>,
                        metrics <span class="op">=</span> <span class="st">"visits"</span>,
                        top <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">daterangeday</span><span class="op">)</span>
<span class="co">#&gt; Estimated runtime: 24.8sec./0.41min.</span>
<span class="co">#&gt; 1 of 31 possible data requests complete. Starting the next 30 requests.</span>
<span class="co">#&gt; Request failed [429]. Retrying in 6 seconds...</span>
<span class="co">#&gt; A total of 60 rows have been pulled.</span>

<span class="co"># Output the first few rows as a formatted table</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df</span>, <span class="fl">10</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">daterangeday</th>
<th align="left">mobiledevicetype</th>
<th align="right">visits</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">2021-01-23</td>
<td align="left">Other</td>
<td align="right">38</td>
</tr>
<tr class="even">
<td align="left">2021-01-23</td>
<td align="left">Mobile Phone</td>
<td align="right">28</td>
</tr>
<tr class="odd">
<td align="left">2021-01-24</td>
<td align="left">Other</td>
<td align="right">41</td>
</tr>
<tr class="even">
<td align="left">2021-01-24</td>
<td align="left">Mobile Phone</td>
<td align="right">25</td>
</tr>
<tr class="odd">
<td align="left">2021-01-25</td>
<td align="left">Other</td>
<td align="right">236</td>
</tr>
<tr class="even">
<td align="left">2021-01-25</td>
<td align="left">Mobile Phone</td>
<td align="right">31</td>
</tr>
<tr class="odd">
<td align="left">2021-01-26</td>
<td align="left">Other</td>
<td align="right">280</td>
</tr>
<tr class="even">
<td align="left">2021-01-26</td>
<td align="left">Mobile Phone</td>
<td align="right">79</td>
</tr>
<tr class="odd">
<td align="left">2021-01-27</td>
<td align="left">Other</td>
<td align="right">266</td>
</tr>
<tr class="even">
<td align="left">2021-01-27</td>
<td align="left">Mobile Phone</td>
<td align="right">62</td>
</tr>
</tbody>
</table>
<p>If the <code>daterange...</code> dimension is not the first dimension (and, for speed reasons, it may make sense to not have it there, as is discussed in the next section), the <code>0</code> can simply be re-located:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aw_freeform_table.html">aw_freeform_table</a></span><span class="op">(</span>date_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">start_date</span>, <span class="va">end_date</span><span class="op">)</span>,
                        dimensions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mobiledevicetype"</span>, <span class="st">"daterangeday"</span><span class="op">)</span>,
                        metrics <span class="op">=</span> <span class="st">"visits"</span>,
                        top <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">mobiledevicetype</span>, <span class="va">daterangeday</span><span class="op">)</span>
<span class="co">#&gt; Estimated runtime: 2.4sec./0.04min.</span>
<span class="co">#&gt; 1 of 3 possible data requests complete. Starting the next 2 requests.</span>
<span class="co">#&gt; A total of 60 rows have been pulled.</span>

<span class="co"># Output the first few rows as a formatted table</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">mobiledevicetype</th>
<th align="left">daterangeday</th>
<th align="right">visits</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Mobile Phone</td>
<td align="left">2021-01-23</td>
<td align="right">28</td>
</tr>
<tr class="even">
<td align="left">Mobile Phone</td>
<td align="left">2021-01-24</td>
<td align="right">25</td>
</tr>
<tr class="odd">
<td align="left">Mobile Phone</td>
<td align="left">2021-01-25</td>
<td align="right">31</td>
</tr>
<tr class="even">
<td align="left">Mobile Phone</td>
<td align="left">2021-01-26</td>
<td align="right">79</td>
</tr>
<tr class="odd">
<td align="left">Mobile Phone</td>
<td align="left">2021-01-27</td>
<td align="right">62</td>
</tr>
<tr class="even">
<td align="left">Mobile Phone</td>
<td align="left">2021-01-28</td>
<td align="right">60</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="multiple-dimensions-multiple-metrics">Multiple Dimensions, Multiple Metrics<a class="anchor" aria-label="anchor" href="#multiple-dimensions-multiple-metrics"></a>
</h3>
<p>Working with multiple dimensions is much easier once you understand two fundamental aspects of the 2.0 API, which may seem contradictory at first:</p>
<ul>
<li><em>Each API call is limited to a single dimension.</em></li>
<li><em>The API can be used to pull data with an unlimited number of dimensions.</em></li>
</ul>
<p>The trick to reconciling these two statements is that any “single dimension” call can be <em>filtered</em> by an unlimited number of <em>other</em> dimensions.</p>
<div class="section level4">
<h4 id="consider-multiple-dimensions-in-analysis-workspace">Consider Multiple Dimensions in Analysis Workspace<a class="anchor" aria-label="anchor" href="#consider-multiple-dimensions-in-analysis-workspace"></a>
</h4>
<p>A thought experiment to explain how this works is to imagine that you are in Analysis Workspace (or, actually go into Analysis Workspace and try this directly to make it a real experiment rather than an experiment of the mind):</p>
<ol style="list-style-type: decimal">
<li>Create a blank freeform table.</li>
<li>Using <em>only</em> your mouse (no keyboard keys allowed!) create a freeform table report that has two dimensions.</li>
</ol>
<p>Each drag-and-drop with your mouse triggers a new API call. To build a freeform table that has <strong>Marketing Channel</strong> broken down by <strong>Mobile Device Type</strong> might look something like the following:</p>
<ol style="list-style-type: decimal">
<li>[Click and drag] <strong>Marketing Channel</strong> onto the freeform table. [API Call #1]</li>
<li>[Click and drag] <strong>Mobile Device Type</strong> onto the first marketing channel in the list: <strong>Direct</strong> (for instance). [API Call #2]</li>
<li>[Click and drag] <strong>Mobile Device Type</strong> onto the second marketing channel in the list: <strong>Paid Search</strong>. [API Call #3]</li>
<li>[Click and drag] <strong>Mobile Device Type</strong> onto the third marketing channel the list: <strong>Natural Search</strong>. [API Call #4]</li>
<li>[Click and drag] <strong>Mobile Device Type</strong> onto the third marketing channel the list: <strong>Display</strong>. [API Call #5]</li>
</ol>
<p>At this point, you’re cursing the constraint of not being able to use the <code>&lt;Shift&gt;</code> key! But, each of those steps is actually an API call that Analysis Worskpace is making to the 2.0 API:</p>
<ol style="list-style-type: decimal">
<li>API Call #1 is a simple, single-dimension call that returns a table listing all of the <strong>Marketing Channel</strong> values.</li>
<li>API Call #2 is <em>also</em> a single-dimension API call, but the single dimension being queried is now <strong>Mobile Device</strong> type. But, that query has a constraint on it, in that it is filtered to only include results where <strong>Marketing Channel = Direct</strong> (the first marketing channel in the list; that’s the value we dragged and dropped <strong>Mobile Device Type</strong> on).</li>
<li>API Call #3 is similar to #2, except the results are filtered for <strong>Marketing Channel = Page Search</strong>).</li>
<li>And so on…</li>
</ol>
<p>These API calls all happen relatively quickly (<em>wildly</em> faster than API calls using the older v1.4 API), but they still all have to happen, and they happen one after another (serially rather than in parallel).</p>
<p>To push this experiment one step farther, think about what you would have to do if you wanted to drill down to a <em>third</em> dimension: <strong>Entry Page</strong>. You would have to repeatedly drag the <strong>Entry Page</strong> dimension onto each of:</p>
<ul>
<li>
<strong>Direct</strong> &gt; <strong>Mobile Phone</strong>
</li>
<li>
<strong>Direct</strong> &gt; <strong>Other</strong>
</li>
<li>
<strong>Direct</strong> &gt; <strong>Tablet</strong>
</li>
<li>
<strong>Paid Search</strong> &gt; <strong>Mobile Phone</strong>
</li>
<li>
<strong>Paid Search</strong> &gt; <strong>Other</strong>
</li>
<li>
<strong>Paid Search</strong> &gt; <strong>Tablet</strong>
</li>
<li>
<strong>Natural Search</strong> &gt; <strong>Mobile Phone</strong>
</li>
<li>
<strong>Natural Search</strong> &gt; <strong>Other</strong>
</li>
<li>
<strong>Natural Search</strong> &gt; <strong>Tablet</strong>
</li>
<li>Etc.</li>
</ul>
<p>For the first call above, the API call for the single dimension <strong>Entry Page</strong> filtered to only include results where <strong>Marketing Channel = Direct</strong> AND <strong>Mobile Device Type = Mobile Phone</strong>.</p>
<p>To build a freeform table in Analysis Workspace that has three dimensions fully broken down would require dozens of drag-and-drop actions! It’s possible that that tedium is one of the reasons that you’re looking to <code>adobeanalyticsr</code> in the first place. As well you should! <code><a href="../reference/aw_freeform_table.html">aw_freeform_table()</a></code> handles these multiple API calls for you!</p>
</div>
<div class="section level4">
<h4 id="multiple-dimensions-with-aw_freeform_table">Multiple Dimensions with aw_freeform_table()<a class="anchor" aria-label="anchor" href="#multiple-dimensions-with-aw_freeform_table"></a>
</h4>
<p>On the one hand, all of the exposition above may seem like overkill, because all you have to do with <code><a href="../reference/aw_freeform_table.html">aw_freeform_table()</a></code> to pull multiple dimensions is to…pass a vector of dimensions to the <code>dimensions</code> argument!</p>
<p>Where things get a little trickier is when it comes to specifying how many rows to include for each dimension level, and, more importantly, for constructing the function calls so that they run as quickly as possible. To illustrate, we’ll explore a scenario where we want to get <strong>Visits</strong> broken down by <strong>Mobile Device Type</strong> and <strong>Browser</strong>.</p>
<p>First, let’s query each of the dimensions independently to see how many unique dimension values we’re dealing with. This isn’t something that is required, but we’re going to do a little math to illustrate the differences that dimension order can make.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">device_types</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aw_freeform_table.html">aw_freeform_table</a></span><span class="op">(</span>date_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">start_date</span>, <span class="va">end_date</span><span class="op">)</span>,
                        dimensions <span class="op">=</span> <span class="st">"mobiledevicetype"</span>,
                        metrics <span class="op">=</span> <span class="st">"visits"</span>,
                        <span class="co"># The default of 5 is probably going to get all of them,</span>
                        <span class="co"># but set a higher cutoff just in case.</span>
                        top <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>
<span class="co">#&gt; A total of 3 rows have been pulled.</span>

<span class="va">browsers</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aw_freeform_table.html">aw_freeform_table</a></span><span class="op">(</span>date_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">start_date</span>, <span class="va">end_date</span><span class="op">)</span>,
                        dimensions <span class="op">=</span> <span class="st">"browser"</span>,
                        metrics <span class="op">=</span> <span class="st">"visits"</span>,
                        <span class="co"># We want to get all of the browsers, so set top as a high </span>
                        <span class="co"># value rather than the default of "5"</span>
                        top <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>
<span class="co">#&gt; A total of 113 rows have been pulled.</span></code></pre></div>
<p>When making our actual call to get both dimensions at once, we have two options for the <code>dimensions</code> argument value:</p>
<ul>
<li><code>dimensions = c("mobiledevicetype", "browser")</code></li>
<li><code>dimensions = c("browser", "mobiledevicetype")</code></li>
</ul>
<p>Assuming we set <code>top</code> appropriately to include all possible values, we should get the same data, ultimately. But, the number of API calls required behind the scenes and, therefore, the time it will take for the function to run, will vary quite a bit between these two!</p>
<p>For <strong><code>dimensions = c("mobiledevicetype", "browser")</code></strong>, the API calls will be:</p>
<ol style="list-style-type: decimal">
<li>One call to get the full list of <code>mobiledevicetype</code> values.</li>
<li>One query for <em>each</em> of the 3 <code>mobiledevicetype</code> values to get each value broken down by <code>browser</code>.</li>
</ol>
<p>This will result in a total of <strong>4 API calls.</strong></p>
<p>Let’s try it out, including logging how long the function takes to run.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">start_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aw_freeform_table.html">aw_freeform_table</a></span><span class="op">(</span>date_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">start_date</span>, <span class="va">end_date</span><span class="op">)</span>,
                        dimensions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mobiledevicetype"</span>, <span class="st">"browser"</span><span class="op">)</span>,
                        metrics <span class="op">=</span> <span class="st">"visits"</span>,
                        top <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">1000</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Estimated runtime: 8.8sec./0.15min.</span>
<span class="co">#&gt; 1 of 11 possible data requests complete. Starting the next 3 requests.</span>
<span class="co">#&gt; A total of 125 rows have been pulled.</span>

<span class="va">end_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># Show the summary for the resulting df for comparison to the next approach.</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>
<span class="co">#&gt;  mobiledevicetype     browser              visits       </span>
<span class="co">#&gt;  Length:125         Length:125         Min.   :   1.00  </span>
<span class="co">#&gt;  Class :character   Class :character   1st Qu.:   1.00  </span>
<span class="co">#&gt;  Mode  :character   Mode  :character   Median :   3.00  </span>
<span class="co">#&gt;                                        Mean   :  56.66  </span>
<span class="co">#&gt;                                        3rd Qu.:  11.00  </span>
<span class="co">#&gt;                                        Max.   :3488.00</span>

<span class="co"># Output how long it took to run the query</span>
<span class="va">end_time</span> <span class="op">-</span> <span class="va">start_time</span>
<span class="co">#&gt; Time difference of 4.994079 secs</span></code></pre></div>
<p>Now, instead, let’s consider what happens if we swap the order of our dimensions and, instead, use <strong><code>dimensions = c("browser", "mobiledevicetype")</code></strong>. Now, the API calls will be:</p>
<ol style="list-style-type: decimal">
<li>One call to get the full list of <code>browser</code> values.</li>
<li>One query for <em>each</em> of the 113 <code>browser</code> values to get each value broken down by <code>mobiledevicetype</code>.</li>
</ol>
<p>This will result in a total of <strong>114 API calls!!!</strong></p>
<p>Let’s try it out:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">start_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aw_freeform_table.html">aw_freeform_table</a></span><span class="op">(</span>date_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">start_date</span>, <span class="va">end_date</span><span class="op">)</span>,
                        dimensions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"browser"</span>, <span class="st">"mobiledevicetype"</span><span class="op">)</span>,
                        metrics <span class="op">=</span> <span class="st">"visits"</span>,
                        top <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Estimated runtime: 800.8sec./13.35min.</span>
<span class="co">#&gt; 1 of 1001 possible data requests complete. Starting the next 113 requests.</span>
<span class="co">#&gt; A total of 125 rows have been pulled.</span>

<span class="va">end_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># Show the summary for the resulting df for comparison to the next approach.</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>
<span class="co">#&gt;    browser          mobiledevicetype       visits       </span>
<span class="co">#&gt;  Length:125         Length:125         Min.   :   1.00  </span>
<span class="co">#&gt;  Class :character   Class :character   1st Qu.:   1.00  </span>
<span class="co">#&gt;  Mode  :character   Mode  :character   Median :   3.00  </span>
<span class="co">#&gt;                                        Mean   :  56.66  </span>
<span class="co">#&gt;                                        3rd Qu.:  11.00  </span>
<span class="co">#&gt;                                        Max.   :3488.00</span>

<span class="co"># Output how long it took to run the query</span>
<span class="va">end_time</span> <span class="op">-</span> <span class="va">start_time</span>
<span class="co">#&gt; Time difference of 1.615242 mins</span></code></pre></div>
<p>This is a <em>BIG</em> difference in run-time even though, aside from the column order being slightly different, the resulting data is identical.</p>
<p>If you followed the Analysis Workspace experiment in the previous section, then another way to think about this is that (without the <code>&lt;Shift&gt;</code> key), breaking down <strong>Mobile Device Type</strong> by <strong>Browser</strong> would require a <em>lot</em> less clicking and dropping than breaking down <strong>Browser</strong> by <strong>Mobile Device Type</strong>. In the latter, you would have to drag <strong>Mobile Device Type</strong> onto <em>each</em> of the numerous <strong>Browser</strong> values one at a time!</p>
<p>The good (great?) news is that you can string as many dimensions together as you would like and then let R just take it from there and get a resulting data frame with multiple dimensions! The order of your dimensions just can have a dramatic effect on how long you have to wait for the results to be returned.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="http://github.com/benrwoodard" class="external-link">Ben Woodard</a>, Tim Wilson.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
